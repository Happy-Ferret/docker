<!DOCTYPE html>
<html>
<head>
  <title>docker.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../";
    var thisFile = "src/docker.js";
    var defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>

  <script src="../fileSearch.js"></script>

  <link rel="stylesheet" href="../fileSearch.css" />

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#docker.js">docker.js</a>
      </div>

      <div class="heading h3">
        <a href="#a-simple-documentation-generator-based-on-docco">A simple documentation generator based on docco</a>
      </div>

      <div class="heading h2">
        <a href="#differences-from-docco">Differences from docco</a>
      </div>

      <div class="heading h2">
        <a href="#node-modules">Node Modules</a>
      </div>

      <div class="heading h2">
        <a href="#markdown-link-overriding">Markdown Link Overriding</a>
      </div>

      <div class="heading h2">
        <a href="#docker-constructor">Docker Constructor</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.doc">Docker.prototype.doc</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.watch">Docker.prototype.watch</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.run">Docker.prototype.run</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.addfiletofree">Docker.prototype.addFileToFree</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.process">Docker.prototype.process</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.processfile">Docker.prototype.processFile</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.decidewhethertoprocess">Docker.prototype.decideWhetherToProcess</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.fileisnewer">Docker.prototype.fileIsNewer</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.parsesections">Docker.prototype.parseSections</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.detectlanguage">Docker.prototype.detectLanguage</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.highlight">Docker.prototype.highlight</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.addanchors">Docker.prototype.addAnchors</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.addlinenumbers">Docker.prototype.addLineNumbers</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.rendercodefile">Docker.prototype.renderCodeFile</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.rendermarkdownfile">Docker.prototype.renderMarkdownFile</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.makeoutputfile">Docker.prototype.makeOutputFile</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.copysharedresources">Docker.prototype.copySharedResources</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.outfile">Docker.prototype.outFile</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.rendertemplate">Docker.prototype.renderTemplate</a>
      </div>

      <div class="heading h2">
        <a href="#docker.prototype.writefile">Docker.prototype.writeFile</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="docker.js">
  <h1>
    <a href="#docker.js" name="docker.js" class="pilcrow"></a>
docker.js
  </h1>
</div>
<div class="pilwrap" id="a-simple-documentation-generator-based-on-docco">
  <h3>
    <a href="#a-simple-documentation-generator-based-on-docco" name="a-simple-documentation-generator-based-on-docco" class="pilcrow"></a>
<em>A simple documentation generator based on <a href="http://jashkenas.github.com/docco/">docco</a></em>
  </h3>
</div>
<p><strong>Docker</strong> is a really simple documentation generator, which originally started out as a
pure-javascript port of <strong>docco</strong>, but which eventually gained many extra little features
which somewhat break docco's philosophy of being a quick-and-dirty thing.</p>
<p>Docker source-code can be found on <a href="https://github.com/jbt/docker">GitHub</a></p>
<p>Take a look at the <a href="http://jashkenas.github.com/docco/">original docco project</a> to get a feel
for the sort of functionality this provides. In short: <strong>Markdown</strong>-based displaying of code comments
next to syntax-highlighted code. This page is the result of running docker against itself.</p>
<p>The command-line usage of docker is somewhat more useful than that of docco. To use, simply run</p>
<pre><code class="sh">./docker -i path/to/code -o path/to/docs [a_file.js a_dir]
</code></pre>
<p>Docker will then recurse into the code root directory (or alternatively just the files
and directories you specify) and document-ize all the files it can.
The folder structure will be preserved in the document root.</p>
<p>More detailed usage instructions and examples can be found in the <a href="../README.md.html">README</a></p>
<div class="pilwrap" id="differences-from-docco">
  <h2>
    <a href="#differences-from-docco" name="differences-from-docco" class="pilcrow"></a>
Differences from docco
  </h2>
</div>
<p>The main differences from docco are:</p>
<ul>
<li>
<p><strong>jsDoc support</strong>: support for <strong>jsDoc</strong>-style code comments, via <a href="https://github.com/visionmedia/dox">Dox</a>. You can see some examples of
the sort of output you get below.</p>
</li>
<li>
<p><strong>Folder Tree</strong> and <strong>Heading Navigation</strong>: collapsible sidebar with folder tree and jump-to
heading links for easy navigation between many files and within long files.</p>
</li>
<li>
<p><strong>Markdown File Support</strong>: support for plain markdown files, like the <a href="../README.md.html">README</a> for this project.</p>
</li>
<li>
<p><strong>Colour Schemes</strong>: support for multiple output colour schemes</p>
</li>
</ul>
<p>So let's get started!</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="node-modules">
  <h2>
    <a href="#node-modules" name="node-modules" class="pilcrow"></a>
Node Modules
  </h2>
</div>
<p>Include lots of node modules</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> stripIndent = <span class="hljs-built_in">require</span>(<span class="hljs-string">'strip-indent'</span>);
<span class="hljs-keyword">var</span> MarkdownIt = <span class="hljs-built_in">require</span>(<span class="hljs-string">'markdown-it'</span>);
<span class="hljs-keyword">var</span> highlight = <span class="hljs-built_in">require</span>(<span class="hljs-string">'highlight.js'</span>);
<span class="hljs-keyword">var</span> repeating = <span class="hljs-built_in">require</span>(<span class="hljs-string">'repeating'</span>);
<span class="hljs-keyword">var</span> mkdirp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mkdirp'</span>);
<span class="hljs-keyword">var</span> extend = <span class="hljs-built_in">require</span>(<span class="hljs-string">'extend'</span>);
<span class="hljs-keyword">var</span> watchr = <span class="hljs-built_in">require</span>(<span class="hljs-string">'watchr'</span>);
<span class="hljs-keyword">var</span> <span class="hljs-keyword">async</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'async'</span>);
<span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">var</span> less = <span class="hljs-built_in">require</span>(<span class="hljs-string">'less'</span>);
<span class="hljs-keyword">var</span> dox = <span class="hljs-built_in">require</span>(<span class="hljs-string">'dox'</span>);
<span class="hljs-keyword">var</span> ejs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ejs'</span>);
<span class="hljs-keyword">var</span> toc = <span class="hljs-built_in">require</span>(<span class="hljs-string">'toc'</span>);
<span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Language details exist in <a href="./languages.js.html">languages.js</a></p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> languages = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./languages'</span>);


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Create an instance of markdown-it, which we'll use for prettyifying all the comments</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> md = <span class="hljs-keyword">new</span> MarkdownIt({
  html: <span class="hljs-literal">true</span>,
  langPrefix: <span class="hljs-string">''</span>,
  highlight: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">str, lang</span>) </span>{
    <span class="hljs-keyword">if</span> (lang &amp;&amp; highlight.getLanguage(lang)) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> highlight.highlight(lang, str).value;
      } <span class="hljs-keyword">catch</span> (__) {}
    }

    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  }
});


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="markdown-link-overriding">
  <h2>
    <a href="#markdown-link-overriding" name="markdown-link-overriding" class="pilcrow"></a>
Markdown Link Overriding
  </h2>
</div>
<p>Relative links to files need to be remapped to their rendered file name,
so that they can be written without <code>.html</code> everywhere else without breaking</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">md.renderer.rules.link_open = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tokens, idx, options, env, self</span>) </span>{
  <span class="hljs-keyword">var</span> hrefIndex = tokens[idx].attrIndex(<span class="hljs-string">'href'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>If the link a relative link, then put '.html' on the end.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (hrefIndex &gt;= <span class="hljs-number">0</span> &amp;&amp; !<span class="hljs-regexp">/\/\//</span>.test(tokens[idx].attrs[hrefIndex][<span class="hljs-number">1</span>])) {
    tokens[idx].attrs[hrefIndex][<span class="hljs-number">1</span>] += <span class="hljs-string">'.html'</span>;
  }

  <span class="hljs-keyword">return</span> self.renderToken.apply(self, <span class="hljs-built_in">arguments</span>);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker-constructor">
  <h2>
    <a href="#docker-constructor" name="docker-constructor" class="pilcrow"></a>
Docker Constructor
  </h2>
</div>
</div>
<div class="body">
<p>Creates a new docker instance. All methods are called on one instance of this object.</p>
<p>Input is an <code>opts</code> containing all the options as specified below.</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> Docker = <span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">opts</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Initialise all opts with default values</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  opts = <span class="hljs-keyword">this</span>.options = extend({
    inDir: path.resolve(<span class="hljs-string">'.'</span>),
    outDir: path.resolve(<span class="hljs-string">'doc'</span>),
    onlyUpdated: <span class="hljs-literal">false</span>,
    colourScheme: <span class="hljs-string">'default'</span>,
    ignoreHidden: <span class="hljs-literal">false</span>,
    sidebarState: <span class="hljs-literal">true</span>,
    exclude: <span class="hljs-literal">false</span>,
    lineNums: <span class="hljs-literal">false</span>,
    multiLineOnly: <span class="hljs-literal">false</span>,
    js: [],
    css: [],
    extras: []
  }, opts);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>Generate an exclude regex for the given pattern</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> opts.exclude === <span class="hljs-string">'string'</span>) {
    <span class="hljs-keyword">this</span>.excludePattern = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'^('</span> +
      opts.exclude.replace(<span class="hljs-regexp">/\./g</span>, <span class="hljs-string">'\\.'</span>)
                  .replace(<span class="hljs-regexp">/\*/g</span>, <span class="hljs-string">'.*'</span>)
                  .replace(<span class="hljs-regexp">/,/g</span>, <span class="hljs-string">'|'</span>) +
      <span class="hljs-string">')(/|$)'</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">this</span>.excludePattern = <span class="hljs-literal">false</span>;
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>Initialise an object which'll store all our directory structure</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>.tree = {};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Load bundled extras</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> extrasRoot = path.resolve(__dirname, <span class="hljs-string">'..'</span>, <span class="hljs-string">'extras'</span>);

  opts.extras.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    opts.js.push(path.join(extrasRoot, e, e + <span class="hljs-string">'.js'</span>));
    opts.css.push(path.join(extrasRoot, e, e + <span class="hljs-string">'.css'</span>));
  });
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.doc">
  <h2>
    <a href="#docker.prototype.doc" name="docker.prototype.doc" class="pilcrow"></a>
Docker.prototype.doc
  </h2>
</div>
</div>
<div class="body">
<p>Generate documentation for a bunch of files</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">files</span>
<span class="dox_type">Array</span>
<span>Array of file paths relative to the <code>inDir</code> to generate documentation for.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.doc = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">files</span>) </span>{
  <span class="hljs-keyword">this</span>.files = files.concat();

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>Start processing, unless we already are</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.running) <span class="hljs-keyword">this</span>.run();
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.watch">
  <h2>
    <a href="#docker.prototype.watch" name="docker.prototype.watch" class="pilcrow"></a>
Docker.prototype.watch
  </h2>
</div>
</div>
<div class="body">
<p>Watches the input directory for file changes and updates docs whenever a file is updated</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">files</span>
<span class="dox_type">Array</span>
<span>Array of file paths relative to the <code>inDir</code> to generate documentation for.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.watch = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">files</span>) </span>{
  <span class="hljs-keyword">this</span>.watching = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">this</span>.watchFiles = files;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>Function to call when a file is changed. We put this on a timeout to account
for several file changes happening in quick succession.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> uto = <span class="hljs-literal">false</span>, self = <span class="hljs-keyword">this</span>;
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (self.running) <span class="hljs-keyword">return</span> (uto = setTimeout(update, <span class="hljs-number">250</span>));
    self.doc(self.watchFiles);
    uto = <span class="hljs-literal">false</span>;
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>Create a watchr instance to watch all changes in the input directory</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  watchr.watch({
    path: <span class="hljs-keyword">this</span>.options.inDir,
    listener: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (!uto) uto = setTimeout(update, <span class="hljs-number">250</span>);
    }
  });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>Aaaaand, go!</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>.doc(files);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.run">
  <h2>
    <a href="#docker.prototype.run" name="docker.prototype.run" class="pilcrow"></a>
Docker.prototype.run
  </h2>
</div>
</div>
<div class="body">
<p>Loops through all the queued file and processes them individually</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.run = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

  <span class="hljs-keyword">this</span>.running = <span class="hljs-literal">true</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>While we stil have any files to process, take the first one and process it</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">async</span>.whilst(
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> self.files.length &gt; <span class="hljs-number">0</span>;
    },
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cb</span>) </span>{
      self.process(self.files.shift(), cb);
    },
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>Once we're done, say we're no longer running and copy over all the static stuff</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      self.running = <span class="hljs-literal">false</span>;
      self.copySharedResources();
    }
  );
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.addfiletofree">
  <h2>
    <a href="#docker.prototype.addfiletofree" name="docker.prototype.addfiletofree" class="pilcrow"></a>
Docker.prototype.addFileToFree
  </h2>
</div>
</div>
<div class="body">
<p>Adds a file to the file tree to show in the sidebar.</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">filename</span>
<span class="dox_type">string</span>
<span>Name of file to add to the tree
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.addFileToTree = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filename</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p>Split the file's path into the individual directories</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  filename = filename.replace(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'^'</span> + path.sep.replace(<span class="hljs-regexp">/([\/\\])/g</span>, <span class="hljs-string">'\\$1'</span>)), <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> bits = filename.split(path.sep);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>Loop through all the directories and process the folder structure into <code>this.tree</code>.</p>
<p><code>this.tree</code> takes the format:</p>
<pre><code class="js"> {
   dirs: {
     <span class="hljs-string">'child_dir_name'</span>: { <span class="hljs-comment">/* same format as tree */</span> },
     <span class="hljs-string">'other_child_name'</span>: <span class="hljs-comment">// etc...</span>
   },
   files: [
     <span class="hljs-string">'filename.js'</span>,
     <span class="hljs-string">'filename2.js'</span>,
     <span class="hljs-comment">// etc...</span>
   ]
 }
</code></pre>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> currDir = <span class="hljs-keyword">this</span>.tree;
  <span class="hljs-keyword">var</span> lastBit = bits.pop();

  bits.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bit</span>) </span>{
    <span class="hljs-keyword">if</span> (!currDir.dirs) currDir.dirs = {};
    <span class="hljs-keyword">if</span> (!currDir.dirs[bit]) currDir.dirs[bit] = {};
    currDir = currDir.dirs[bit];
  });
  <span class="hljs-keyword">if</span> (!currDir.files) currDir.files = [];

  <span class="hljs-keyword">if</span> (currDir.files.indexOf(lastBit) === -<span class="hljs-number">1</span>) currDir.files.push(lastBit);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.process">
  <h2>
    <a href="#docker.prototype.process" name="docker.prototype.process" class="pilcrow"></a>
Docker.prototype.process
  </h2>
</div>
</div>
<div class="body">
<p>Process the given file. If it's a directory, list all the children and queue those.
If it's a file, add it to the queue.</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">file</span>
<span class="dox_type">string</span>
<span>Path to the file to process
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">cb</span>
<span class="dox_type">function</span>
<span>Callback to call when done
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.process = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">file, cb</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25"></a>
</div>
<p>If we should be ignoring this file, do nothing and immediately callback.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.excludePattern &amp;&amp; <span class="hljs-keyword">this</span>.excludePattern.test(file)) {
    cb();
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

  <span class="hljs-keyword">var</span> resolved = path.resolve(<span class="hljs-keyword">this</span>.options.inDir, file);
  fs.lstat(resolved, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lstatCb</span>(<span class="hljs-params">err, stat</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26"></a>
</div>
<p>Something unexpected happened on the filesystem.
Nothing really that we can do about it, so throw it and be done with it</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">return</span> cb(err);
    }

    <span class="hljs-keyword">if</span> (stat &amp;&amp; stat.isSymbolicLink()) {
      fs.readlink(resolved, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, link</span>) </span>{
        <span class="hljs-keyword">if</span> (err) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27"></a>
</div>
<p>Something unexpected happened on the filesystem.
Nothing really that we can do about it, so throw it and be done with it</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          <span class="hljs-keyword">return</span> cb(err);
        }

        resolved = path.resolve(path.dirname(resolved), link);

        fs.exists(resolved, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">exists</span>) </span>{
          <span class="hljs-keyword">if</span> (!exists) {
            <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'Unable to follow symlink to '</span> + resolved + <span class="hljs-string">': file does not exist'</span>);
            cb(<span class="hljs-literal">null</span>);
          } <span class="hljs-keyword">else</span> {
            fs.lstat(resolved, lstatCb);
          }
        });
      });
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (stat &amp;&amp; stat.isDirectory()) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28"></a>
</div>
<p>Find all children of the directory and queue those</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      fs.readdir(resolved, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, list</span>) </span>{
        <span class="hljs-keyword">if</span> (err) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29"></a>
</div>
<p>Something unexpected happened on the filesystem.
Nothing really that we can do about it, so throw it and be done with it</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          <span class="hljs-keyword">return</span> cb(err);
        }

        list.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<p>For everything in the directory, queue it unless it looks hiden and we've
been told to ignore hidden files.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          <span class="hljs-keyword">if</span> (self.options.ignoreHidden &amp;&amp; f.charAt(<span class="hljs-number">0</span>).match(<span class="hljs-regexp">/[\._]/</span>)) <span class="hljs-keyword">return</span>;
          self.files.push(path.join(file, f));
        });
        cb();
      });
    } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31"></a>
</div>
<p>Wahey, we have a normal file. Go ahead and process it then.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      self.processFile(file, cb);
    }
  });
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.processfile">
  <h2>
    <a href="#docker.prototype.processfile" name="docker.prototype.processfile" class="pilcrow"></a>
Docker.prototype.processFile
  </h2>
</div>
</div>
<div class="body">
<p>Processes a given file. At this point we know the file exists and
isn't any kind of directory or symlink.</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">file</span>
<span class="dox_type">string</span>
<span>Path to the file to process
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">cb</span>
<span class="dox_type">function</span>
<span>Callback to call when done
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.processFile = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">file, cb</span>) </span>{
  <span class="hljs-keyword">var</span> resolved = path.resolve(<span class="hljs-keyword">this</span>.options.inDir, file);
  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<p>First, check to see whether we actually should be processing this file and bail if not</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>.decideWhetherToProcess(resolved, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">shouldProcess</span>) </span>{
    <span class="hljs-keyword">if</span> (!shouldProcess) <span class="hljs-keyword">return</span> cb();

    fs.readFile(resolved, <span class="hljs-string">'utf-8'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, data</span>) </span>{
      <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> cb(err);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<p>Grab the language details for the file and bail if we don't understand it.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">var</span> lang = self.detectLanguage(resolved, data);
      <span class="hljs-keyword">if</span> (lang === <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span> cb();

      self.addFileToTree(file);

      <span class="hljs-keyword">switch</span> (lang.type) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'markdown'</span>:
        self.renderMarkdownFile(data, resolved, cb);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'code'</span>:
        <span class="hljs-keyword">var</span> sections = self.parseSections(data, lang);
        self.highlight(sections, lang);
        self.renderCodeFile(sections, lang, resolved, cb);
        <span class="hljs-keyword">break</span>;
      }
    });
  });
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.decidewhethertoprocess">
  <h2>
    <a href="#docker.prototype.decidewhethertoprocess" name="docker.prototype.decidewhethertoprocess" class="pilcrow"></a>
Docker.prototype.decideWhetherToProcess
  </h2>
</div>
</div>
<div class="body">
<p>Decide whether or not a file should be processed. If the <code>onlyUpdated</code>
flag was set on initialization, only allow processing of files that
are newer than their counterpart generated doc file.</p>
<p>Fires a callback function with either true or false depending on whether
or not the file should be processed</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">filename</span>
<span class="dox_type">string</span>
<span>The name of the file to check
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">callback</span>
<span class="dox_type">function</span>
<span>Callback function
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.decideWhetherToProcess = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filename, callback</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36"></a>
</div>
<p>If we should be processing all files, then yes, we should process this one</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.options.onlyUpdated) <span class="hljs-keyword">return</span> callback(<span class="hljs-literal">true</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37"></a>
</div>
<p>Find the doc this file would be compiled to</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> outFile = <span class="hljs-keyword">this</span>.outFile(filename);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38"></a>
</div>
<p>See whether the file is newer than the output</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>.fileIsNewer(filename, outFile, callback);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.fileisnewer">
  <h2>
    <a href="#docker.prototype.fileisnewer" name="docker.prototype.fileisnewer" class="pilcrow"></a>
Docker.prototype.fileIsNewer
  </h2>
</div>
</div>
<div class="body">
<p>Sees whether one file is newer than another</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">file</span>
<span class="dox_type">string</span>
<span>File to check
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">otherFile</span>
<span class="dox_type">string</span>
<span>File to compare to
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">callback</span>
<span class="dox_type">function</span>
<span>Callback to fire with true if file is newer than otherFile
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.fileIsNewer = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">file, otherFile, callback</span>) </span>{
  fs.stat(otherFile, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, outStat</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40"></a>
</div>
<p>If the output file doesn't exist, then definitely process this file</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (err &amp;&amp; err.code == <span class="hljs-string">'ENOENT'</span>) <span class="hljs-keyword">return</span> callback(<span class="hljs-literal">true</span>);

    fs.stat(file, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, inStat</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41"></a>
</div>
<p>Process the file if the input is newer than the output</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      callback(+inStat.mtime &gt; +outStat.mtime);
    });
  });
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.parsesections">
  <h2>
    <a href="#docker.prototype.parsesections" name="docker.prototype.parsesections" class="pilcrow"></a>
Docker.prototype.parseSections
  </h2>
</div>
</div>
<div class="body">
<p>Parse the content of a file into individual sections.
A section is defined to be one block of code with an accompanying comment</p>
<p>Returns an array of section objects, which take the form</p>
<pre><code class="js"> {
   doc_text: <span class="hljs-string">'foo'</span>, <span class="hljs-comment">// String containing comment content</span>
   code_text: <span class="hljs-string">'bar'</span> <span class="hljs-comment">// Accompanying code</span>
 }
</code></pre>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">data</span>
<span class="dox_type">string</span>
<span>The contents of the script file
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">lang</span>
<span class="dox_type">object</span>
<span>The language data for the script file
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Array</span>
<span>array of section objects
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.parseSections = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data, lang</span>) </span>{
  <span class="hljs-keyword">var</span> lines = data.split(<span class="hljs-string">'\n'</span>);

  <span class="hljs-keyword">var</span> section = {
    docs: <span class="hljs-string">''</span>,
    code: <span class="hljs-string">''</span>
  };

  <span class="hljs-keyword">var</span> sections = [];

  <span class="hljs-keyword">var</span> inMultiLineComment = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> multiLine = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> jsDocData;

  <span class="hljs-keyword">var</span> commentRegex = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'^\\s*'</span> + lang.comment + <span class="hljs-string">'\\s?'</span>);

  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;


  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mark</span>(<span class="hljs-params">a, stripParas</span>) </span>{
    <span class="hljs-keyword">var</span> h = md.render(a.replace(<span class="hljs-regexp">/(^\s*|\s*$)/</span>, <span class="hljs-string">''</span>));
    <span class="hljs-keyword">return</span> stripParas ? h.replace(<span class="hljs-regexp">/&lt;\/?p&gt;/g</span>, <span class="hljs-string">''</span>) : h;
  }

  lines.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">line, i</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43"></a>
</div>
<p>Only match against parts of the line that don't appear in strings</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> matchable = line.replace(<span class="hljs-regexp">/(["'])((?:[^\\\1]|(?:\\\\)*?\\[^\\])*?)\1/g</span>, <span class="hljs-string">'$1$1'</span>);
    <span class="hljs-keyword">if</span> (lang.literals) {
      lang.literals.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">replace</span>) </span>{
        matchable = matchable.replace(replace[<span class="hljs-number">0</span>], replace[<span class="hljs-number">1</span>]);
      });
    }

    <span class="hljs-keyword">if</span> (lang.multiLine) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44"></a>
</div>
<p>If we are currently in a multiline comment, behave differently</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> (inMultiLineComment) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45"></a>
</div>
<p>End-multiline comments should match regardless of whether they're 'quoted'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (line.match(lang.multiLine[<span class="hljs-number">1</span>])) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46"></a>
</div>
<p>Once we have reached the end of the multiline, take the whole content
of the multiline comment, and parse it as jsDoc.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          inMultiLineComment = <span class="hljs-literal">false</span>;

          multiLine += line;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47"></a>
</div>
<p>Replace block comment delimiters with whitespace of the same length
This way we can safely outdent without breaking too many things if the
comment has been deliberately indented. For example, the lines in the
followinc comment should all be outdented equally:</p>
<pre><code class="c">   <span class="hljs-comment">/* A big long multiline
      comment that should get
      outdented properly       */</span>
</code></pre>

        </td>
        <td class="code highlight">
          <pre class="javascript">          multiLine = multiLine
            .replace(lang.multiLine[<span class="hljs-number">0</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">return</span> repeating(<span class="hljs-string">' '</span>, a.length); })
            .replace(lang.multiLine[<span class="hljs-number">1</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">return</span> repeating(<span class="hljs-string">' '</span>, a.length); });

          multiLine = stripIndent(multiLine);

          <span class="hljs-keyword">if</span> (lang.jsDoc) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48"></a>
</div>
<p>Strip off leading * characters.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            multiLine = multiLine.replace(<span class="hljs-regexp">/^[ \t]*\*? ?/gm</span>, <span class="hljs-string">''</span>);

            jsDocData = dox.parseComment(multiLine, { raw: <span class="hljs-literal">true</span> });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49"></a>
</div>
<p>Put markdown parser on the data so it can be accessed in the template</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            jsDocData.md = mark;
            section.docs += self.renderTemplate(<span class="hljs-string">'jsDoc'</span>, jsDocData);
          } <span class="hljs-keyword">else</span> {
            section.docs += <span class="hljs-string">'\n'</span> + multiLine + <span class="hljs-string">'\n'</span>;
          }
          multiLine = <span class="hljs-string">''</span>;
        } <span class="hljs-keyword">else</span> {
          multiLine += line + <span class="hljs-string">'\n'</span>;
        }
        <span class="hljs-keyword">return</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50"></a>
</div>
<p>We want to match the start of a multiline comment only if the line doesn't also match the
end of the same comment, or if a single-line comment is started before the multiline
So for example the following would not be treated as a multiline starter:</p>
<pre><code class="js">alert(<span class="hljs-string">'foo'</span>); <span class="hljs-comment">// Alert some foo /* Random open comment thing</span>
</code></pre>

        </td>
        <td class="code highlight">
          <pre class="javascript">        matchable.match(lang.multiLine[<span class="hljs-number">0</span>]) &amp;&amp;
        !matchable.replace(lang.multiLine[<span class="hljs-number">0</span>], <span class="hljs-string">''</span>).match(lang.multiLine[<span class="hljs-number">1</span>]) &amp;&amp;
        (!lang.comment || !matchable.split(lang.multiLine[<span class="hljs-number">0</span>])[<span class="hljs-number">0</span>].match(commentRegex))
      ) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51"></a>
</div>
<p>Here we start parsing a multiline comment. Store away the current section and start a new one</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (section.code) {
          <span class="hljs-keyword">if</span> (!section.code.match(<span class="hljs-regexp">/^\s*$/</span>) || !section.docs.match(<span class="hljs-regexp">/^\s*$/</span>)) sections.push(section);
          section = { docs: <span class="hljs-string">''</span>, code: <span class="hljs-string">''</span> };
        }
        inMultiLineComment = <span class="hljs-literal">true</span>;
        multiLine = line + <span class="hljs-string">'\n'</span>;
        <span class="hljs-keyword">return</span>;
      }
    }
    <span class="hljs-keyword">if</span> (
      !self.options.multiLineOnly &amp;&amp;
      lang.comment &amp;&amp;
      matchable.match(commentRegex) &amp;&amp;
      (!lang.commentsIgnore || !matchable.match(lang.commentsIgnore)) &amp;&amp;
      !matchable.match(<span class="hljs-regexp">/#!/</span>)
    ) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52"></a>
</div>
<p>This is for single-line comments. Again, store away the last section and start a new one</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> (section.code) {
        <span class="hljs-keyword">if</span> (!section.code.match(<span class="hljs-regexp">/^\s*$/</span>) || !section.docs.match(<span class="hljs-regexp">/^\s*$/</span>)) sections.push(section);
        section = { docs: <span class="hljs-string">''</span>, code: <span class="hljs-string">''</span> };
      }
      section.docs += line.replace(commentRegex, <span class="hljs-string">''</span>) + <span class="hljs-string">'\n'</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!lang.commentsIgnore || !line.match(lang.commentsIgnore)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53"></a>
</div>
<p>If this is the first line of active code, store it in the section
so we can grab it for line numbers later</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> (!section.firstCodeLine) {
        section.firstCodeLine = i + <span class="hljs-number">1</span>;
      }
      section.code += line + <span class="hljs-string">'\n'</span>;
    }
  });

  sections.push(section);
  <span class="hljs-keyword">return</span> sections;
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.detectlanguage">
  <h2>
    <a href="#docker.prototype.detectlanguage" name="docker.prototype.detectlanguage" class="pilcrow"></a>
Docker.prototype.detectLanguage
  </h2>
</div>
</div>
<div class="body">
<p>Provides language-specific params for a given file name.</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">filename</span>
<span class="dox_type">string</span>
<span>The name of the file to test
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">contents</span>
<span class="dox_type">string</span>
<span>The contents of the file (to check for shebang)
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">object</span>
<span>Object containing all of the language-specific params
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.detectLanguage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filename, contents</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55"></a>
</div>
<p>First try to detect the language from the file extension</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> ext = path.extname(filename);
  ext = ext.replace(<span class="hljs-regexp">/^\./</span>, <span class="hljs-string">''</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56"></a>
</div>
<p>Bit of a hacky way of incorporating .C for C++</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (ext === <span class="hljs-string">'.C'</span>) <span class="hljs-keyword">return</span> languages.cpp;
  ext = ext.toLowerCase();

  <span class="hljs-keyword">var</span> base = path.basename(filename);
  base = base.toLowerCase();

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> languages) {
    <span class="hljs-keyword">if</span> (!languages.hasOwnProperty(i)) <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">if</span> (languages[i].extensions &amp;&amp;
      languages[i].extensions.indexOf(ext) !== -<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> languages[i];
    <span class="hljs-keyword">if</span> (languages[i].names &amp;&amp;
      languages[i].names.indexOf(base) !== -<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> languages[i];
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57"></a>
</div>
<p>If that doesn't work, see if we can grab a shebang</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
  <span class="hljs-keyword">var</span> shebangRegex = <span class="hljs-regexp">/^#!\s*(?:\/usr\/bin\/env)?\s*(?:[^\n]*\/)*([^\/\n]+)(?:\n|$)/</span>;
  <span class="hljs-keyword">var</span> match = shebangRegex.exec(contents);
  <span class="hljs-keyword">if</span> (match) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j <span class="hljs-keyword">in</span> languages) {
      <span class="hljs-keyword">if</span> (!languages.hasOwnProperty(j)) <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">if</span> (languages[j].executables &amp;&amp; languages[j].executables.indexOf(match[<span class="hljs-number">1</span>]) !== -<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> languages[j];
    }
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58"></a>
</div>
<p>If we still can't figure it out, give up and return false.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.highlight">
  <h2>
    <a href="#docker.prototype.highlight" name="docker.prototype.highlight" class="pilcrow"></a>
Docker.prototype.highlight
  </h2>
</div>
</div>
<div class="body">
<p>Highlights all the sections of a file using <strong>highlightjs</strong>
Given an array of section objects, loop through them, and for each
section generate pretty html for the comments and the code, and put them in
<code>docHtml</code> and <code>codeHtml</code> respectively</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">sections</span>
<span class="dox_type">Array</span>
<span>Array of section objects
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">language</span>
<span class="dox_type">string</span>
<span>Language ith which to highlight the file
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.highlight = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sections, lang</span>) </span>{
  sections.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">section</span>) </span>{
    section.codeHtml = highlight.highlight(lang.highlightLanguage || lang.language, section.code).value;
    section.docHtml = md.render(section.docs);
  });
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.addanchors">
  <h2>
    <a href="#docker.prototype.addanchors" name="docker.prototype.addanchors" class="pilcrow"></a>
Docker.prototype.addAnchors
  </h2>
</div>
</div>
<div class="body">
<p>Automatically assign an id to each section based on any headings using <strong>toc</strong> helpers</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">section</span>
<span class="dox_type">object</span>
<span>The section object to look at
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">idx</span>
<span class="dox_type">number</span>
<span>The index of the section in the whole array.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">headings</span>
<span class="dox_type">Object</span>
<span>Object in which to keep track of headings for avoiding clashes
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.addAnchors = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">docHtml, idx, headings</span>) </span>{
  <span class="hljs-keyword">var</span> headingRegex = <span class="hljs-regexp">/&lt;h(\d)(\s*[^&gt;]*)&gt;([\s\S]+?)&lt;\/h\1&gt;/gi</span>; <span class="hljs-comment">// toc.defaults.headers</span>

  <span class="hljs-keyword">if</span> (docHtml.match(headingRegex)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-61" id="section-61"></a>
</div>
<p>If there is a heading tag, pick out the first one (likely the most important), sanitize
the name a bit to make it more friendly for IDs, then use that</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    docHtml = docHtml.replace(headingRegex, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, level, attrs, content</span>) </span>{
      <span class="hljs-keyword">var</span> id = toc.unique(headings.ids, toc.anchor(content));

      headings.list.push({ id: id, text: toc.untag(content), level: level });
      <span class="hljs-keyword">return</span> [
        <span class="hljs-string">'&lt;div class="pilwrap" id="'</span> + id + <span class="hljs-string">'"&gt;'</span>,
        <span class="hljs-string">'  &lt;h'</span> + level + attrs + <span class="hljs-string">'&gt;'</span>,
        <span class="hljs-string">'    &lt;a href="#'</span> + id + <span class="hljs-string">'" name="'</span> + id + <span class="hljs-string">'" class="pilcrow"&gt;&lt;/a&gt;'</span>,
        content,
        <span class="hljs-string">'  &lt;/h'</span> + level + <span class="hljs-string">'&gt;'</span>,
        <span class="hljs-string">'&lt;/div&gt;'</span>
      ].join(<span class="hljs-string">'\n'</span>);
    });
  } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-62" id="section-62"></a>
</div>
<p>If however we can't find a heading, then just use the section index instead.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    docHtml = [
      <span class="hljs-string">'&lt;div class="pilwrap"&gt;'</span>,
      <span class="hljs-string">'  &lt;a class="pilcrow" href="#section-'</span> + (idx + <span class="hljs-number">1</span>) + <span class="hljs-string">'" id="section-'</span> + (idx + <span class="hljs-number">1</span>) + <span class="hljs-string">'"&gt;&lt;/a&gt;'</span>,
      <span class="hljs-string">'&lt;/div&gt;'</span>,
      docHtml
    ].join(<span class="hljs-string">'\n'</span>);
  }

  <span class="hljs-keyword">return</span> docHtml;
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.addlinenumbers">
  <h2>
    <a href="#docker.prototype.addlinenumbers" name="docker.prototype.addlinenumbers" class="pilcrow"></a>
Docker.prototype.addLineNumbers
  </h2>
</div>
</div>
<div class="body">
<p>Adds line numbers to rendered code HTML</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">html</span>
<span class="dox_type">string</span>
<span>The code HTML
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">first</span>
<span class="dox_type">number</span>
<span>Line number of the first code line
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.addLineNumbers = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html, first</span>) </span>{
  <span class="hljs-keyword">var</span> lines = html.split(<span class="hljs-string">'\n'</span>);

  lines = lines.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">line, i</span>) </span>{
    <span class="hljs-keyword">var</span> n = first + i;
    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;a class="line-num" href="#line-'</span> + n + <span class="hljs-string">'" id="line-'</span> + n + <span class="hljs-string">'" data-line="'</span> + n + <span class="hljs-string">'"&gt;&lt;/a&gt;  '</span> + line;
  });

  <span class="hljs-keyword">return</span> lines.join(<span class="hljs-string">'\n'</span>);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.rendercodefile">
  <h2>
    <a href="#docker.prototype.rendercodefile" name="docker.prototype.rendercodefile" class="pilcrow"></a>
Docker.prototype.renderCodeFile
  </h2>
</div>
</div>
<div class="body">
<p>Given an array of sections, render them all out to a nice HTML file</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">sections</span>
<span class="dox_type">Array</span>
<span>Array of sections containing parsed data
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">language</span>
<span class="dox_type">Object</span>
<span>The language data for the file in question
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">filename</span>
<span class="dox_type">string</span>
<span>Name of the file being processed
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">cb</span>
<span class="dox_type">function</span>
<span>Callback function to fire when we're done
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.renderCodeFile = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sections, language, filename, cb</span>) </span>{
  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

  <span class="hljs-keyword">var</span> headings = { ids: {}, list: [] };

  sections.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">section, i</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-65" id="section-65"></a>
</div>
<p>Add anchors to all headings in all sections</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    section.docHtml = self.addAnchors(section.docHtml, i, headings);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-66" id="section-66"></a>
</div>
<p>Add line numbers of we need them</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (self.options.lineNums) {
      section.codeHtml = self.addLineNumbers(section.codeHtml, section.firstCodeLine);
    }
  });

  <span class="hljs-keyword">var</span> content = <span class="hljs-keyword">this</span>.renderTemplate(<span class="hljs-string">'code'</span>, {
    title: path.basename(filename),
    sections: sections,
    language: language.language
  });

  <span class="hljs-keyword">this</span>.makeOutputFile(filename, content, headings, cb);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.rendermarkdownfile">
  <h2>
    <a href="#docker.prototype.rendermarkdownfile" name="docker.prototype.rendermarkdownfile" class="pilcrow"></a>
Docker.prototype.renderMarkdownFile
  </h2>
</div>
</div>
<div class="body">
<p>Renders the output for a Markdown file into HTML</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">data</span>
<span class="dox_type">string</span>
<span>The markdown file content
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">filename</span>
<span class="dox_type">string</span>
<span>Name of the file being processed
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">cb</span>
<span class="dox_type">function</span>
<span>Callback function to fire when we're done
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.renderMarkdownFile = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data, filename, cb</span>) </span>{
  <span class="hljs-keyword">var</span> content = md.render(data);

  <span class="hljs-keyword">var</span> headings = { ids: {}, list: [] };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-68" id="section-68"></a>
</div>
<p>Add anchors to all headings</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  content = <span class="hljs-keyword">this</span>.addAnchors(content, <span class="hljs-number">0</span>, headings);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-69" id="section-69"></a>
</div>
<p>Wrap up with necessary classes</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  content = <span class="hljs-string">'&lt;div class="docs markdown"&gt;'</span> + content + <span class="hljs-string">'&lt;/div&gt;'</span>;

  <span class="hljs-keyword">this</span>.makeOutputFile(filename, content, headings, cb);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.makeoutputfile">
  <h2>
    <a href="#docker.prototype.makeoutputfile" name="docker.prototype.makeoutputfile" class="pilcrow"></a>
Docker.prototype.makeOutputFile
  </h2>
</div>
</div>
<div class="body">
<p>Shared code for generating an output file with the given content.
Renders the given content in a template along with its headings and
writes it to the output file.</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">filename</span>
<span class="dox_type">string</span>
<span>Path to the input file
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">content</span>
<span class="dox_type">string</span>
<span>The string content to render into the template
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">headings</span>
<span class="dox_type">Object</span>
<span>List of headings + ids
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">cb</span>
<span class="dox_type">function</span>
<span>Callback to call when done
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.makeOutputFile = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filename, content, headings, cb</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-71" id="section-71"></a>
</div>
<p>Decide which path to store the output on.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> outFile = <span class="hljs-keyword">this</span>.outFile(filename);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-72" id="section-72"></a>
</div>
<p>Calculate the location of the input root relative to the output file.
This is necessary so we can link to the stylesheet in the output HTML using
a relative href rather than an absolute one</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> outDir = path.dirname(outFile);
  <span class="hljs-keyword">var</span> relativeOut = path.resolve(outDir)
                      .replace(path.resolve(<span class="hljs-keyword">this</span>.options.outDir), <span class="hljs-string">''</span>)
                      .replace(<span class="hljs-regexp">/^[\/\\]/</span>, <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> levels = relativeOut == <span class="hljs-string">''</span> ? <span class="hljs-number">0</span> : relativeOut.split(path.sep).length;
  <span class="hljs-keyword">var</span> relDir = repeating(<span class="hljs-string">'../'</span>, levels);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-73" id="section-73"></a>
</div>
<p>Render the html file using our template</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> html = <span class="hljs-keyword">this</span>.renderTemplate(<span class="hljs-string">'tmpl'</span>, {
    title: path.basename(filename),
    relativeDir: relDir,
    content: content,
    headings: headings,
    sidebar: <span class="hljs-keyword">this</span>.options.sidebarState,
    filename: filename.replace(<span class="hljs-keyword">this</span>.options.inDir, <span class="hljs-string">''</span>).replace(<span class="hljs-regexp">/^[\\\/]/</span>, <span class="hljs-string">''</span>),
    js: <span class="hljs-keyword">this</span>.options.js.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{ <span class="hljs-keyword">return</span> path.basename(f); }),
    css: <span class="hljs-keyword">this</span>.options.css.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{ <span class="hljs-keyword">return</span> path.basename(f); })
  });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-74" id="section-74"></a>
</div>
<p>Recursively create the output directory, clean out any old version of the
output file, then save our new file.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>.writeFile(outFile, html, <span class="hljs-string">'Generated: '</span> + outFile.replace(<span class="hljs-keyword">this</span>.options.outDir, <span class="hljs-string">''</span>), cb);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.copysharedresources">
  <h2>
    <a href="#docker.prototype.copysharedresources" name="docker.prototype.copysharedresources" class="pilcrow"></a>
Docker.prototype.copySharedResources
  </h2>
</div>
</div>
<div class="body">
<p>Copies the shared CSS and JS files to the output directories</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.copySharedResources = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
  self.writeFile(
    path.join(self.options.outDir, <span class="hljs-string">'doc-filelist.js'</span>),
    <span class="hljs-string">'var tree='</span> + <span class="hljs-built_in">JSON</span>.stringify(self.tree) + <span class="hljs-string">';'</span>,
    <span class="hljs-string">'Saved file tree to doc-filelist.js'</span>
  );

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-76" id="section-76"></a>
</div>
<p>Generate the CSS file using LESS. First, load the less file.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  fs.readFile(path.join(__dirname, <span class="hljs-string">'..'</span>, <span class="hljs-string">'res'</span>, <span class="hljs-string">'style.less'</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, file</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-77" id="section-77"></a>
</div>
<p>Now try to grab the colours out of whichever highlight theme was used</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> hlpath = <span class="hljs-built_in">require</span>.resolve(<span class="hljs-string">'highlight.js'</span>);
    <span class="hljs-keyword">var</span> cspath = path.resolve(path.dirname(hlpath), <span class="hljs-string">'..'</span>, <span class="hljs-string">'styles'</span>);
    <span class="hljs-keyword">var</span> colours = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./getColourScheme'</span>)(self.options.colourScheme);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-78" id="section-78"></a>
</div>
<p>Now compile the LESS to CSS</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    less.render(file.toString().replace(<span class="hljs-string">'COLOURSCHEME'</span>, self.options.colourScheme), {
      paths: [ cspath ],
      globalVars: colours
    }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, out</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-79" id="section-79"></a>
</div>
<p>Now we've got the rendered CSS, write it out.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      self.writeFile(
        path.join(self.options.outDir, <span class="hljs-string">'doc-style.css'</span>),
        out.css,
        <span class="hljs-string">'Compiled CSS to doc-style.css'</span>
      );
    });
  });

  fs.readFile(path.join(__dirname, <span class="hljs-string">'..'</span>, <span class="hljs-string">'res'</span>, <span class="hljs-string">'script.js'</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, file</span>) </span>{
    self.writeFile(
      path.join(self.options.outDir, <span class="hljs-string">'doc-script.js'</span>),
      file,
      <span class="hljs-string">'Copied JS to doc-script.js'</span>
    );
  });

  <span class="hljs-keyword">this</span>.options.js.concat(<span class="hljs-keyword">this</span>.options.css).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ext</span>) </span>{
    <span class="hljs-keyword">var</span> fn = path.basename(ext);
    fs.readFile(path.resolve(ext), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, file</span>) </span>{
      self.writeFile(path.join(self.options.outDir, fn), file, <span class="hljs-string">'Copied '</span> + fn);
    });
  });
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.outfile">
  <h2>
    <a href="#docker.prototype.outfile" name="docker.prototype.outfile" class="pilcrow"></a>
Docker.prototype.outFile
  </h2>
</div>
</div>
<div class="body">
<p>Generates the output path for a given input file</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">filename</span>
<span class="dox_type">string</span>
<span>Name of the input file
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">string</span>
<span>Name to use for the generated doc file
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.outFile = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filename</span>) </span>{
  <span class="hljs-keyword">return</span> path.normalize(filename.replace(path.resolve(<span class="hljs-keyword">this</span>.options.inDir), <span class="hljs-keyword">this</span>.options.outDir) + <span class="hljs-string">'.html'</span>);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.rendertemplate">
  <h2>
    <a href="#docker.prototype.rendertemplate" name="docker.prototype.rendertemplate" class="pilcrow"></a>
Docker.prototype.renderTemplate
  </h2>
</div>
</div>
<div class="body">
<p>Renders an EJS template with the given data</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">templateName</span>
<span class="dox_type">string</span>
<span>The name of the template to use
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">obj</span>
<span class="dox_type">object</span>
<span>Object containing parameters for the template
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">string</span>
<span>Rendered output
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.renderTemplate = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">templateName, obj</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-82" id="section-82"></a>
</div>
<p>If we haven't already loaded the template, load it now.
It's a bit messy to be using readFileSync I know, but this
is the easiest way for now.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._templates) <span class="hljs-keyword">this</span>._templates = {};
  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._templates[templateName]) {
    <span class="hljs-keyword">var</span> tmplFile = path.join(__dirname, <span class="hljs-string">'..'</span>, <span class="hljs-string">'res'</span>, templateName + <span class="hljs-string">'.ejs'</span>);
    <span class="hljs-keyword">this</span>._templates[templateName] = ejs.compile(fs.readFileSync(tmplFile).toString());
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._templates[templateName](obj);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="docker.prototype.writefile">
  <h2>
    <a href="#docker.prototype.writefile" name="docker.prototype.writefile" class="pilcrow"></a>
Docker.prototype.writeFile
  </h2>
</div>
</div>
<div class="body">
<p>Saves a file, making sure the directory already exists and overwriting any existing file</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">filename</span>
<span class="dox_type">string</span>
<span>The name of the file to save
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">fileContent</span>
<span class="dox_type">string</span>
<span>Content to save to the file
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">doneLog</span>
<span class="dox_type">string</span>
<span>String to console.log when done
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">doneCallback</span>
<span class="dox_type">function</span>
<span>Callback to fire when done
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Docker.prototype.writeFile = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filename, fileContent, doneLog, doneCallback</span>) </span>{
  mkdirp(path.dirname(filename), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    fs.writeFile(filename, fileContent, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (doneLog) <span class="hljs-built_in">console</span>.log(doneLog);
      <span class="hljs-keyword">if</span> (doneCallback) doneCallback();
    });
  });
};

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
